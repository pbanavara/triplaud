var directionsDisplay;
var directionsDisplayOptions;
var directionsService = new google.maps.DirectionsService();
var polyLineArray = [];
var map;

function initialize() {
  directionsDisplayOptions = {
	  hideRouteList:false
  };
  directionsDisplay = new google.maps.DirectionsRenderer(directionsDisplayOptions);
	var bangalore;
	var startAddr = "Bangalore";
	var geocoder = new google.maps.Geocoder();
	geocoder.geocode( { 'address': startAddr}, function(startResults, status) {
		if (status == google.maps.GeocoderStatus.OK) {
			 bangalore = startResults[0].geometry.location;
		} else { alert("Incorrect address");
		}
  var myOptions = {
    zoom:12,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    center: bangalore
  };
  map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  map.setCenter(bangalore);
	});
  //displayRoutes();
  //directionsDisplay.setMap(map);
  showTrafficData();
}

function showTrafficData() {
  var data = {"results":[{"timestamp":1328204695259,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T17:45:04.153Z","updatedAt":"2012-02-02T17:45:04.153Z","objectId":"sR2bCy6roB"},{"timestamp":1328204740310,"bearing":0,"n":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T17:45:40.833Z","updatedAt":"2012-02-02T17:45:40.833Z","objectId":"55X5nvvWWH"},{"timestamp":1328204830430,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T17:47:10.919Z","updatedAt":"2012-02-02T17:47:10.919Z","objectId":"NJVUwYR6fm"},{"timestamp":1328291628037,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.964035669136244,"longitude":77.60511257380892},"speed":0,"accuracy":40,"createdAt":"2012-02-02T17:53:55.843Z","updatedAt":"2012-02-02T17:53:55.843Z","objectId":"H1uzA9u6fh"},{"timestamp":1328205370679,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T17:56:12.031Z","updatedAt":"2012-02-02T17:56:12.031Z","objectId":"r40TTcWoO4"},{"timestamp":1328205415672,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T17:56:56.511Z","updatedAt":"2012-02-02T17:56:56.511Z","objectId":"aDsUKhD5tX"},{"timestamp":1328205505748,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T17:58:26.682Z","updatedAt":"2012-02-02T17:58:26.682Z","objectId":"tdwxtqgVBr"},{"timestamp":1328205550758,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T17:59:11.476Z","updatedAt":"2012-02-02T17:59:11.476Z","objectId":"6VvKjhLACN"},{"timestamp":1328291971000,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.964395313713402,"longitude":77.60568582998184},"speed":1.1074128,"accuracy":50,"createdAt":"2012-02-02T17:59:35.590Z","updatedAt":"2012-02-02T17:59:35.590Z","objectId":"ebVnNz2gc8"},{"timestamp":1328292007000,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.964810740885953,"longitude":77.60413068011478},"speed":2.3415914,"accuracy":50,"createdAt":"2012-02-02T18:00:09.474Z","updatedAt":"2012-02-02T18:00:09.474Z","objectId":"cFp63upp67"},{"timestamp":1328292029000,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.96478533768394,"longitude":77.60495163718716},"speed":2.5724356,"accuracy":50,"createdAt":"2012-02-02T18:00:33.327Z","updatedAt":"2012-02-02T18:00:33.327Z","objectId":"zJ9IkbJ0ar"},{"timestamp":1328292092000,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.964028184806754,"longitude":77.60503442684058},"speed":3.5365736,"accuracy":45,"createdAt":"2012-02-02T18:01:36.506Z","updatedAt":"2012-02-02T18:01:36.506Z","objectId":"80ggbJBGA4"},{"timestamp":1328205730874,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T18:02:11.696Z","updatedAt":"2012-02-02T18:02:11.696Z","objectId":"EW2G1ekHs7"},{"timestamp":1328205775945,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:02:56.637Z","updatedAt":"2012-02-02T18:02:56.637Z","objectId":"N51dlrhS8r"},{"timestamp":1328292304000,"bearing":165.42535,"location":{"__type":"GeoPoint","latitude":12.963409967868557,"longitude":77.60517228233418},"speed":1.7884638,"accuracy":45,"createdAt":"2012-02-02T18:05:06.874Z","updatedAt":"2012-02-02T18:05:06.874Z","objectId":"0TG9oKRxAW"},{"timestamp":1328205910947,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T18:05:10.585Z","updatedAt":"2012-02-02T18:05:10.585Z","objectId":"zer6GSnO67"},{"timestamp":1328292326000,"bearing":349.5831,"location":{"__type":"GeoPoint","latitude":12.963983077692687,"longitude":77.60505268459141},"speed":2.1043897,"accuracy":40,"createdAt":"2012-02-02T18:05:30.402Z","updatedAt":"2012-02-02T18:05:30.402Z","objectId":"yNcEsU338Q"},{"timestamp":1328205955953,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:05:56.823Z","updatedAt":"2012-02-02T18:05:56.823Z","objectId":"mvDT5eqefp"},{"timestamp":1328292355000,"bearing":355.23593,"location":{"__type":"GeoPoint","latitude":12.965041717192575,"longitude":77.60479780301505},"speed":0,"accuracy":40,"createdAt":"2012-02-02T18:05:57.782Z","updatedAt":"2012-02-02T18:05:57.782Z","objectId":"Gkp2MMHMEH"},{"timestamp":1328292373000,"bearing":355.23593,"location":{"__type":"GeoPoint","latitude":12.964173476115876,"longitude":77.60529707467478},"speed":0,"accuracy":40,"createdAt":"2012-02-02T18:06:17.885Z","updatedAt":"2012-02-02T18:06:17.885Z","objectId":"8oxqdDpW8p"},{"timestamp":1328292406000,"bearing":9.400749,"location":{"__type":"GeoPoint","latitude":12.964679682188322,"longitude":77.60508544820848},"speed":2.33098,"accuracy":50,"createdAt":"2012-02-02T18:06:50.526Z","updatedAt":"2012-02-02T18:06:50.526Z","objectId":"S8GVf7orVy"},{"timestamp":1328206045999,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9638975,"longitude":77.6057139},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:07:26.262Z","updatedAt":"2012-02-02T18:07:26.262Z","objectId":"AN7bicju6N"},{"timestamp":1328292524000,"bearing":173.48164,"location":{"__type":"GeoPoint","latitude":12.964059435842465,"longitude":77.60459279611352},"speed":0,"accuracy":35,"createdAt":"2012-02-02T18:08:47.941Z","updatedAt":"2012-02-02T18:08:47.941Z","objectId":"3EJyoZZhNV"},{"timestamp":1328206135991,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T18:08:56.686Z","updatedAt":"2012-02-02T18:08:56.686Z","objectId":"Nt2qVWq4s9"},{"timestamp":1328206180999,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:09:39.832Z","updatedAt":"2012-02-02T18:09:39.832Z","objectId":"3x1t18Mvjz"},{"timestamp":1328292597000,"bearing":310.97824,"location":{"__type":"GeoPoint","latitude":12.96465838909176,"longitude":77.60409966086593},"speed":2.0929372,"accuracy":45,"createdAt":"2012-02-02T18:10:00.962Z","updatedAt":"2012-02-02T18:10:00.962Z","objectId":"NDmEoOazHQ"},{"timestamp":1328292623000,"bearing":278.61935,"location":{"__type":"GeoPoint","latitude":12.964426576160148,"longitude":77.60356245586978},"speed":0,"accuracy":40,"createdAt":"2012-02-02T18:10:27.636Z","updatedAt":"2012-02-02T18:10:27.636Z","objectId":"4ea7iZC5p2"},{"timestamp":1328292630000,"bearing":295.0146,"location":{"__type":"GeoPoint","latitude":12.964199442747223,"longitude":77.60397172818847},"speed":0.34146428,"accuracy":25,"createdAt":"2012-02-02T18:10:32.610Z","updatedAt":"2012-02-02T18:10:32.610Z","objectId":"92EeMj6Bch"},{"timestamp":1328292635000,"bearing":303.81042,"location":{"__type":"GeoPoint","latitude":12.964052380061858,"longitude":77.60441986140123},"speed":0.525431,"accuracy":20,"createdAt":"2012-02-02T18:10:37.637Z","updatedAt":"2012-02-02T18:10:37.637Z","objectId":"tN0vGqHA9o"},{"timestamp":1328292649000,"bearing":347.87747,"location":{"__type":"GeoPoint","latitude":12.963991093534698,"longitude":77.60489251983148},"speed":0,"accuracy":15,"createdAt":"2012-02-02T18:10:53.737Z","updatedAt":"2012-02-02T18:10:53.737Z","objectId":"oMI1PlVtIk"},{"timestamp":1328206361052,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9638975,"longitude":77.6057139},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:12:41.620Z","updatedAt":"2012-02-02T18:12:41.620Z","objectId":"kWlv1s0Lq0"},{"timestamp":1328206406060,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T18:13:26.544Z","updatedAt":"2012-02-02T18:13:26.544Z","objectId":"ozCD98jiZ7"},{"timestamp":1328206451097,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:14:21.648Z","updatedAt":"2012-02-02T18:14:21.648Z","objectId":"offwLHUtyz"},{"timestamp":1328206496102,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9634493,"longitude":77.6060763},"speed":0,"accuracy":678,"createdAt":"2012-02-02T18:14:54.218Z","updatedAt":"2012-02-02T18:14:54.218Z","objectId":"fEM0zYbqZv"},{"timestamp":1328206541151,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9638975,"longitude":77.6057139},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:15:40.126Z","updatedAt":"2012-02-02T18:15:40.126Z","objectId":"fS5XxKtvuu"},{"timestamp":1328292974000,"bearing":114.471825,"location":{"__type":"GeoPoint","latitude":12.963901792158513,"longitude":77.60536512174566},"speed":0.91555923,"accuracy":35,"createdAt":"2012-02-02T18:16:22.829Z","updatedAt":"2012-02-02T18:16:22.829Z","objectId":"gBLFzjPdrl"},{"timestamp":1328206586173,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:16:24.789Z","updatedAt":"2012-02-02T18:16:24.789Z","objectId":"10RBp6uhZj"},{"timestamp":1328206631186,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9627079,"longitude":77.6055185},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:17:11.040Z","updatedAt":"2012-02-02T18:17:11.040Z","objectId":"WdwM2OUDEG"},{"timestamp":1328293054000,"bearing":1.3155308,"location":{"__type":"GeoPoint","latitude":12.964358845077811,"longitude":77.60541030924126},"speed":0.93827605,"accuracy":35,"createdAt":"2012-02-02T18:17:37.187Z","updatedAt":"2012-02-02T18:17:37.187Z","objectId":"EV4m2yreon"},{"timestamp":1328206676184,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9618632,"longitude":77.6058159},"speed":0,"accuracy":736,"createdAt":"2012-02-02T18:17:54.215Z","updatedAt":"2012-02-02T18:17:54.215Z","objectId":"l5hsE9rqNk"},{"timestamp":1328206721190,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9634751,"longitude":77.6058625},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:18:39.191Z","updatedAt":"2012-02-02T18:18:39.191Z","objectId":"nRzkLoS34m"},{"timestamp":1328206766199,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9640125,"longitude":77.6058781},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:19:26.580Z","updatedAt":"2012-02-02T18:19:26.580Z","objectId":"B6x2jop4g2"},{"timestamp":1328206811195,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:20:10.883Z","updatedAt":"2012-02-02T18:20:10.883Z","objectId":"hHQMnudjEK"},{"timestamp":1328293250000,"bearing":13.882067,"location":{"__type":"GeoPoint","latitude":12.964496802062744,"longitude":77.60489391500651},"speed":0.90117216,"accuracy":45,"createdAt":"2012-02-02T18:20:53.521Z","updatedAt":"2012-02-02T18:20:53.521Z","objectId":"t3c7RECaU6"},{"timestamp":1328293299000,"bearing":337.87036,"location":{"__type":"GeoPoint","latitude":12.96403682739165,"longitude":77.60483590022214},"speed":0,"accuracy":25,"createdAt":"2012-02-02T18:21:41.708Z","updatedAt":"2012-02-02T18:21:41.708Z","objectId":"4BwiRbdqDO"},{"timestamp":1328206901244,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9618632,"longitude":77.6058159},"speed":0,"accuracy":736,"createdAt":"2012-02-02T18:21:41.711Z","updatedAt":"2012-02-02T18:21:41.711Z","objectId":"10X7aK5oVm"},{"timestamp":1328206946261,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:22:25.779Z","updatedAt":"2012-02-02T18:22:25.779Z","objectId":"NFcxCtVbcj"},{"timestamp":1328207036340,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9627079,"longitude":77.6055185},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:23:56.039Z","updatedAt":"2012-02-02T18:23:56.039Z","objectId":"RElHD7OfTP"},{"timestamp":1328293459000,"bearing":178.96767,"location":{"__type":"GeoPoint","latitude":12.963583670363965,"longitude":77.60489586772847},"speed":0,"accuracy":45,"createdAt":"2012-02-02T18:24:22.695Z","updatedAt":"2012-02-02T18:24:22.695Z","objectId":"NXSzTvxNqF"},{"timestamp":1328207081358,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9618632,"longitude":77.6058159},"speed":0,"accuracy":736,"createdAt":"2012-02-02T18:24:41.575Z","updatedAt":"2012-02-02T18:24:41.575Z","objectId":"LPRNAlOomS"},{"timestamp":1328207126380,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:25:26.360Z","updatedAt":"2012-02-02T18:25:26.360Z","objectId":"btLBN4milF"},{"timestamp":1328293569000,"bearing":233.65929,"location":{"__type":"GeoPoint","latitude":12.963768768859703,"longitude":77.60443206677236},"speed":0.33184028,"accuracy":45,"createdAt":"2012-02-02T18:26:12.141Z","updatedAt":"2012-02-02T18:26:12.141Z","objectId":"zNEOzâ„¢rjy"},{"timestamp":1328207171387,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9618632,"longitude":77.6058159},"speed":0,"accuracy":736,"createdAt":"2012-02-02T18:26:12.165Z","updatedAt":"2012-02-02T18:26:12.165Z","objectId":"kzrG0B0zBq"},{"timestamp":1328293608000,"bearing":41.872467,"location":{"__type":"GeoPoint","latitude":12.96392132117495,"longitude":77.60487947232279},"speed":0,"accuracy":20,"createdAt":"2012-02-02T18:26:53.920Z","updatedAt":"2012-02-02T18:26:53.920Z","objectId":"ueAjcinRRH"},{"timestamp":1328207216431,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9634751,"longitude":77.6058625},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:26:57.619Z","updatedAt":"2012-02-02T18:26:57.619Z","objectId":"Njo8y4edI7"},{"timestamp":1328207306464,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:28:26.290Z","updatedAt":"2012-02-02T18:28:26.290Z","objectId":"rHUARvb3zC"},{"timestamp":1328207441510,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9638975,"longitude":77.6057139},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:30:41.157Z","updatedAt":"2012-02-02T18:30:41.157Z","objectId":"fVjamv7fy7"},{"timestamp":1328293848000,"bearing":359.13565,"location":{"__type":"GeoPoint","latitude":12.964375298797268,"longitude":77.60483713547507},"speed":1.1344609,"accuracy":15,"createdAt":"2012-02-02T18:30:52.342Z","updatedAt":"2012-02-02T18:30:52.342Z","objectId":"PuFiya6wUT"},{"timestamp":1328207486548,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9618632,"longitude":77.6058159},"speed":0,"accuracy":736,"createdAt":"2012-02-02T18:31:28.694Z","updatedAt":"2012-02-02T18:31:28.694Z","objectId":"58IeutqaOV"},{"timestamp":1328207531530,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:32:11.068Z","updatedAt":"2012-02-02T18:32:11.068Z","objectId":"zTtBQ1NkWe"},{"timestamp":1328207576565,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9638975,"longitude":77.6057139},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:32:56.238Z","updatedAt":"2012-02-02T18:32:56.238Z","objectId":"beLIU816OI"},{"timestamp":1328207621569,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9635527,"longitude":77.6052212},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:33:41.289Z","updatedAt":"2012-02-02T18:33:41.289Z","objectId":"jvqVJZPezD"},{"timestamp":1328207756632,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9634752,"longitude":77.6058625},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:35:57.011Z","updatedAt":"2012-02-02T18:35:57.011Z","objectId":"7RQOKiXemm"},{"timestamp":1328207846643,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9642424,"longitude":77.6062065},"speed":0,"accuracy":678,"createdAt":"2012-02-02T18:37:24.907Z","updatedAt":"2012-02-02T18:37:24.907Z","objectId":"XxUK4l74hg"},{"timestamp":1328207891686,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9633028,"longitude":77.6056162},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:38:11.481Z","updatedAt":"2012-02-02T18:38:11.481Z","objectId":"VHwpxAHd1A"},{"timestamp":1328207936693,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9627079,"longitude":77.6055185},"speed":0,"accuracy":587,"createdAt":"2012-02-02T18:38:56.341Z","updatedAt":"2012-02-02T18:38:56.341Z","objectId":"NnstYVOBYq"},{"timestamp":1328207981737,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9618632,"longitude":77.6058159},"speed":0,"accuracy":736,"createdAt":"2012-02-02T18:39:41.896Z","updatedAt":"2012-02-02T18:39:41.896Z","objectId":"OgRPqBuJcS"},{"timestamp":1328208026761,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.964409,"longitude":77.604914},"speed":0,"accuracy":567,"createdAt":"2012-02-02T18:40:27.938Z","updatedAt":"2012-02-02T18:40:27.938Z","objectId":"xXdf1Hrw2P"},{"timestamp":1328294453000,"bearing":337.2353,"location":{"__type":"GeoPoint","latitude":12.96308766411246,"longitude":77.60759040836957},"speed":0,"accuracy":45,"createdAt":"2012-02-02T18:40:55.007Z","updatedAt":"2012-02-02T18:40:55.007Z","objectId":"KQEz7utSgJ"},{"timestamp":1328294466000,"bearing":243.45851,"location":{"__type":"GeoPoint","latitude":12.963190404921269,"longitude":77.60689885764221},"speed":1.1531008,"accuracy":40,"createdAt":"2012-02-02T18:41:09.676Z","updatedAt":"2012-02-02T18:41:09.676Z","objectId":"dvCT1zba48"},{"timestamp":1328208071761,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9652652,"longitude":77.6046068},"speed":0,"accuracy":567,"createdAt":"2012-02-02T18:41:09.710Z","updatedAt":"2012-02-02T18:41:09.710Z","objectId":"IMBgBZqeD0"},{"timestamp":1328294476000,"bearing":166.71568,"location":{"__type":"GeoPoint","latitude":12.96266065667125,"longitude":77.60665513118137},"speed":2.2705498,"accuracy":45,"createdAt":"2012-02-02T18:41:18.172Z","updatedAt":"2012-02-02T18:41:18.172Z","objectId":"qGwIPbcSWF"},{"timestamp":1328294487000,"bearing":139.26274,"location":{"__type":"GeoPoint","latitude":12.962489024057545,"longitude":77.60741371713672},"speed":2.929078,"accuracy":40,"createdAt":"2012-02-02T18:41:31.745Z","updatedAt":"2012-02-02T18:41:31.745Z","objectId":"9KgqNwsrj6"},{"timestamp":1328294499000,"bearing":193.55276,"location":{"__type":"GeoPoint","latitude":12.962019920301316,"longitude":77.60751279009291},"speed":10.086317,"accuracy":25,"createdAt":"2012-02-02T18:41:42.733Z","updatedAt":"2012-02-02T18:41:42.733Z","objectId":"weLQBpVfUl"},{"timestamp":1328294505000,"bearing":206.2114,"location":{"__type":"GeoPoint","latitude":12.96161550256196,"longitude":77.60724315761507},"speed":6.518088,"accuracy":20,"createdAt":"2012-02-02T18:41:46.945Z","updatedAt":"2012-02-02T18:41:46.945Z","objectId":"0vslTHyuej"},{"timestamp":1328294515000,"bearing":196.96143,"location":{"__type":"GeoPoint","latitude":12.96114071578563,"longitude":77.60707067451003},"speed":6.8418083,"accuracy":30,"createdAt":"2012-02-02T18:41:57.606Z","updatedAt":"2012-02-02T18:41:57.606Z","objectId":"jfSQtZVebH"},{"timestamp":1328208119692,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9628963,"longitude":77.6064405},"speed":0,"accuracy":681,"createdAt":"2012-02-02T18:41:58.535Z","updatedAt":"2012-02-02T18:41:58.535Z","objectId":"aDJ9GcAyz7"},{"timestamp":1328294520000,"bearing":190.6198,"location":{"__type":"GeoPoint","latitude":12.960667728934437,"longitude":77.60697036729346},"speed":9.57482,"accuracy":35,"createdAt":"2012-02-02T18:42:01.988Z","updatedAt":"2012-02-02T18:42:01.988Z","objectId":"TzrGIZ1kdl"},{"timestamp":1328294525000,"bearing":194.82753,"location":{"__type":"GeoPoint","latitude":12.960093366584259,"longitude":77.60682500997258},"speed":10.541771,"accuracy":30,"createdAt":"2012-02-02T18:42:08.367Z","updatedAt":"2012-02-02T18:42:08.367Z","objectId":"O5PBDtJU28"},{"timestamp":1328294529000,"bearing":199.07103,"location":{"__type":"GeoPoint","latitude":12.959585261730727,"longitude":77.60665527844206},"speed":12.934748,"accuracy":35,"createdAt":"2012-02-02T18:42:10.948Z","updatedAt":"2012-02-02T18:42:10.948Z","objectId":"MCQaHXeedL"},{"timestamp":1328294533000,"bearing":197.18222,"location":{"__type":"GeoPoint","latitude":12.959061746852191,"longitude":77.606495299499},"speed":12.913979,"accuracy":25,"createdAt":"2012-02-02T18:42:14.870Z","updatedAt":"2012-02-02T18:42:14.870Z","objectId":"ZCeoQxUcSU"},{"timestamp":1328294537000,"bearing":197.9193,"location":{"__type":"GeoPoint","latitude":12.95857857669025,"longitude":77.60634124339474},"speed":12.529125,"accuracy":40,"createdAt":"2012-02-02T18:42:18.991Z","updatedAt":"2012-02-02T18:42:18.991Z","objectId":"NnR7uAWVbl"},{"timestamp":1328294550000,"bearing":171.73495,"location":{"__type":"GeoPoint","latitude":12.9579150137127,"longitude":77.60697978497534},"speed":3.3864038,"accuracy":50,"createdAt":"2012-02-02T18:42:33.863Z","updatedAt":"2012-02-02T18:42:33.863Z","objectId":"SWees1L7EF"},{"timestamp":1328208152149,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9575727,"longitude":77.603286},"speed":0,"accuracy":931,"createdAt":"2012-02-02T18:42:40.003Z","updatedAt":"2012-02-02T18:42:40.003Z","objectId":"uL6Re1OPN8"},{"timestamp":1328208196887,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9547774,"longitude":77.605413},"speed":0,"accuracy":825,"createdAt":"2012-02-02T18:43:27.059Z","updatedAt":"2012-02-02T18:43:27.059Z","objectId":"bahCsPqYvD"},{"timestamp":1328294609000,"bearing":184.30916,"location":{"__type":"GeoPoint","latitude":12.952938237102634,"longitude":77.60556096138009},"speed":14.780008,"accuracy":50,"createdAt":"2012-02-02T18:43:31.062Z","updatedAt":"2012-02-02T18:43:31.062Z","objectId":"9zWrC5aLHy"},{"timestamp":1328294632000,"bearing":159.82791,"location":{"__type":"GeoPoint","latitude":12.951250895316416,"longitude":77.60507066725414},"speed":12.143034,"accuracy":50,"createdAt":"2012-02-02T18:43:53.672Z","updatedAt":"2012-02-02T18:43:53.672Z","objectId":"dAzrlhOsQH"},{"timestamp":1328294643000,"bearing":156.44193,"location":{"__type":"GeoPoint","latitude":12.949495656532106,"longitude":77.60561501448667},"speed":14.502964,"accuracy":35,"createdAt":"2012-02-02T18:44:06.605Z","updatedAt":"2012-02-02T18:44:06.605Z","objectId":"tSb2qq5zo5"},{"timestamp":1328208242287,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.949691,"longitude":77.606359},"speed":0,"accuracy":679,"createdAt":"2012-02-02T18:44:10.014Z","updatedAt":"2012-02-02T18:44:10.014Z","objectId":"qij6VDbtJT"},{"timestamp":1328294651000,"bearing":161.86983,"location":{"__type":"GeoPoint","latitude":12.948965145150957,"longitude":77.60578147535122},"speed":16.292006,"accuracy":20,"createdAt":"2012-02-02T18:44:21.224Z","updatedAt":"2012-02-02T18:44:21.224Z","objectId":"ac5hIaKIEX"},{"timestamp":1328294655000,"bearing":163.3002,"location":{"__type":"GeoPoint","latitude":12.94840526614566,"longitude":77.60592920141553},"speed":18.023346,"accuracy":20,"createdAt":"2012-02-02T18:44:21.914Z","updatedAt":"2012-02-02T18:44:21.914Z","objectId":"NrJnA9vN2T"},{"timestamp":1328294659000,"bearing":165.39923,"location":{"__type":"GeoPoint","latitude":12.947851723866325,"longitude":77.6060927568179},"speed":17.71752,"accuracy":20,"createdAt":"2012-02-02T18:44:21.944Z","updatedAt":"2012-02-02T18:44:21.944Z","objectId":"gQ7alucdb4"},{"timestamp":1328294662000,"bearing":165.49402,"location":{"__type":"GeoPoint","latitude":12.947391683803227,"longitude":77.6062044656395},"speed":17.83033,"accuracy":20,"createdAt":"2012-02-02T18:44:23.694Z","updatedAt":"2012-02-02T18:44:23.694Z","objectId":"h8z5ttUFzH"},{"timestamp":1328294665000,"bearing":165.64734,"location":{"__type":"GeoPoint","latitude":12.946928477539146,"longitude":77.60633611465197},"speed":17.814287,"accuracy":20,"createdAt":"2012-02-02T18:44:26.777Z","updatedAt":"2012-02-02T18:44:26.777Z","objectId":"E3OUi0AeRk"},{"timestamp":1328294668000,"bearing":164.43439,"location":{"__type":"GeoPoint","latitude":12.946478552851882,"longitude":77.60646791345803},"speed":16.874584,"accuracy":20,"createdAt":"2012-02-02T18:44:29.984Z","updatedAt":"2012-02-02T18:44:29.984Z","objectId":"UqpUQfnLYM"},{"timestamp":1328294672000,"bearing":162.32036,"location":{"__type":"GeoPoint","latitude":12.945956597542304,"longitude":77.60661831327913},"speed":13.422683,"accuracy":20,"createdAt":"2012-02-02T18:44:33.797Z","updatedAt":"2012-02-02T18:44:33.797Z","objectId":"Esc9eM9lcR"},{"timestamp":1328208288814,"bearing":0,"location":{"__type":"GeoPoint","latitude":12.9455441,"longitude":77.607225},"speed":0,"accuracy":727,"createdAt":"2012-02-02T18:44:56.630Z","updatedAt":"2012-02-02T18:44:56.630Z","objectId":"pSsTZkLTYW"},{"timestamp":1328294698000,"bearing":169.98279,"location":{"__type":"GeoPoint","latitude":12.94520737661655,"longitude":77.60737002474953},"speed":0,"accuracy":30,"createdAt":"2012-02-02T18:44:59.868Z","updatedAt":"2012-02-02T18:44:59.868Z","objectId":"Zw9ZsliItL"},{"timestamp":1328294708000,"bearing":158.49484,"location":{"__type":"GeoPoint","latitude":12.94473216613408,"longitude":77.6073654889426},"speed":9.590932,"accuracy":35,"createdAt":"2012-02-02T18:45:13.259Z","updatedAt":"2012-02-02T18:45:13.259Z","objectId":"72mi0VIrQW"},{"timestamp":1328294714000,"bearing":161.38452,"location":{"__type":"GeoPoint","latitude":12.944218703525351,"longitude":77.60734242801266},"speed":10.878124,"accuracy":35,"createdAt":"2012-02-02T18:45:15.959Z","updatedAt":"2012-02-02T18:45:15.959Z","objectId":"VXAQTxI74s"}]};

  var results = data.results;
  var j=0;
  var newResults = []; 
  for(var i=0;i<results.length;++i) {
    var speed = results[i].speed;
    if(speed !== 0){
      newResults[j] = results[i];
      j++;
    }
  }
  /*
  var polyLine = new google.maps.Polyline({ //Displaying the path using the polyLine object.
		      path:newResults, 
		       strokeColor:"#FF0000",
		       strokeOpacity:1.0,
		       strokeWeight:2
	      });
  polyLine.setMap(map);
        */
     var lat = newResults[0].location.latitude;
     var longi = newResults[0].location.longitude;
     var speed = newResults[0].speed;
     var latLong = new google.maps.LatLng(lat, longi);
     alert(latLong);
     var marker = new google.maps.Marker({position:latLong,map:map,animation:google.maps.Animation.DROP});
}

function displayRoutes() {
var searchString = document.location.search;

// strip off the leading '?'
searchString = searchString.substring(1);
var latitude = new Array();
var gLatLonArray = new Array();
var nvPairs = searchString.split("&");
for (var i = 0; i < nvPairs.length; i++)
{
     var nvPair = nvPairs[i].split("=");
      latitude[i] = nvPair[1];
}
//alert(latitude.length);
for (var k=0; k<latitude.length; ++k) {
  var latLon = latitude[k].split(":");
  //alert("LatLongArray" + latLon);
  var gLatLon = new google.maps.LatLng(latLon[0],latLon[1]);
  gLatLonArray[k] = gLatLon;
}
  

  clearRoutes(); //Clear old existing routes first
  /*
  var start = document.getElementById("start").value;
  var end = document.getElementById("end").value;
  var request = { // Construct the directionsRequest object with the provideAlternatives set to true. This is then passed to the directionsService object.
    origin:start,
    destination:end,
    travelMode: google.maps.TravelMode.DRIVING,
    provideRouteAlternatives:true
  };
  */
  var request = { // Construct the directionsRequest object with the provideAlternatives set to true. This is then passed to the directionsService object.
    origin:gLatLonArray[0],
    destination:gLatLonArray[1],
    travelMode: google.maps.TravelMode.DRIVING,
    provideRouteAlternatives:true
  };
  var polyLine = null;
  //For the time bieng filler for color coding.
  var color = [];
  color[0] = "#FF0000";
  color[1] = "#00FFFF";
  color[2] = "#00FF00";
  color[3] = "#FFFF00";
  var colorIndex = 0;
  directionsService.route(request, function(result, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      var routes = result.routes; // An array of DirectionsRoute objects.
      for(var i=0;i<routes.length;++i) { // Loop through the array to get the individual directionsRoute object.
	      var overviewPath = routes[i].overview_path; //An overviewPath is the array containing all the latLongs of the individual route.
        console.log(overviewPath);
	      polyLine = new google.maps.Polyline({ //Displaying the path using the polyLine object.
		      path:overviewPath, 
		       strokeColor: color[colorIndex], 
		       strokeOpacity:1.0,
		       strokeWeight:2
	      });
        colorIndex++;
	      polyLine.setMap(map);
        polyLineArray[i] = polyLine;
      }
    }
  });
}

/*
 * This function will be called to clear all the existing routes from the map.
 */
function clearRoutes() {
  for(var i=0;i<polyLineArray.length;++i){
    polyLineArray[i].setMap(null);
  }
}
